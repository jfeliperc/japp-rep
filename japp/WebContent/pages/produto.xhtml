<ui:composition template="../templates/t_base.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	
	<ui:define name="extscript">
		<script>
	      $(function() {
		    $( "#frmProduto:datainclusao" ).datepicker();
		  });
		</script>
	</ui:define>

    <ui:define name="conteudo">
    	<h:form id="frmProduto">
	    	<p:panel header="Consulta Produtos" style="width:99%; height: 95%; " rendered="#{!produtoMb.mostrarLista}">
		      	<table><tr><td width="1300px">
		      	<div style="padding-left: 10px">		      	
		      		
		      		<nav class="navbar navbar-default" style="min-height: 30px !important;">
		  				<div class="container-fluid">		    
		      				<span class="btn-group navbar-left">
					      		<h:panelGroup id="botoesPanel" layout="block">		      			
				      				<table><tr><td width="20px">
				      				<h:commandLink action="#{produtoMb.limpar()}" value="" ><h:graphicImage value="/css/img/limpar.png" width="20px" height="20px" /></h:commandLink>
				      				</td><td width="20px">
				      				<h:commandLink action="#{produtoMb.buscar()}" value="" ><h:graphicImage value="/css/img/buscar.png" width="20px" height="20px" /></h:commandLink>
				      				</td><td width="20px">
				      				<h:commandLink action="#{produtoMb.salvar()}" value="" ><h:graphicImage value="/css/img/salvar.png" width="20px" height="20px" /></h:commandLink>
				      				</td><td width="20px">
				      				<h:commandLink action="#{produtoMb.excluir()}" value="" ><h:graphicImage value="/css/img/excluir.png" width="20px" height="20px" /></h:commandLink>
				      				</td></tr></table>		      				
					      		</h:panelGroup>
				      		</span>
				      		
				      		<span class="btn-group navbar-right">				      			
						        <div class="btn-group">									
									<p:commandButton id="dynBtnOpc" value="Opções" type="button" icon="ui-icon-extlink"/>
								    <p:menu overlay="true" trigger="dynBtnOpc" my="left top" at="left bottom">
								        <p:menuitem value="Ver Lista" action="#{produtoMb.alternaMostraLista()}" update="messagePanel" ajax="false"/>
								        <p:menuitem value="Grupo/Tipo Produto" action="tipoGrupoProduto" update="messagePanel" ajax="false"/>								        								        
								    </p:menu>
									
								</div>								
				      		</span>
				      	</div>
				    </nav>	
				    	
			      	<h:panelGroup id="messagePanel" layout="block">
	                	<h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
	                	<hr/>
		            </h:panelGroup>
		            
			      	<h:panelGrid columns="4" cellspacing="5px" cellpadding="5" id="gridForm" style="border:none !important;">
	                    <h:outputLabel value="Id" for="id" />
	                    <h:inputText id="id" value="#{produtoMb.produto.id}" title="ProdutoTitle_id}" required="false" 
	                    	requiredMessage="ProdutoRequiredMessage_id}"/>
	                    <h:panelGroup></h:panelGroup>
	                    <h:panelGroup></h:panelGroup>	
	                    	
	                    <h:outputLabel value="Nome" for="nome" />
	                    <h:inputText id="nome" value="#{produtoMb.produto.nome}" title="Nome" required="false" 
	                    	requiredMessage="ProdutoRequiredMessage_nome}" size="50"/>
	                    
	                    <h:outputLabel value="Descricao" for="descricao" />
	                    <h:inputText id="descricao" value="#{produtoMb.produto.descricao}" title="Descricao" size="50" />
	                    
	                    <h:outputLabel value="Un. Medida" for="medida" />
	                    <h:panelGroup id="pnlGrpMedida" style="border:none; padding: 0px 0px;">
		                    <h:selectOneMenu id="medida" value="#{produtoMb.produto.medida}" title="Un. Medida" style="width:200px">
		                        <f:selectItem itemValue="Un" itemLabel="Unidade" noSelectionOption="true"/>
		                        <f:selectItem itemValue="Cx" itemLabel="Caixa" />
		                        <f:selectItem itemValue="Fr" itemLabel="Fardo" />
		                        <f:selectItem itemValue="Kg" itemLabel="Kg" />		      
		                    </h:selectOneMenu>		                    
	                    </h:panelGroup>                    
	                    
	                    <h:outputLabel value="Cód. Externo" for="cod_externo" />
	                    <h:inputText id="cod_externo" value="#{produtoMb.produto.codExterno}" title="Código Externo" />
	                    
	                    <h:outputLabel value="Qtd. Média Compra" for="qtdRefCompra" />
	                    <h:inputText id="qtdRefCompra" value="#{produtoMb.produto.qtdRefCompra}" />
	                    
	                    <h:outputLabel value="Qtd. Média Saída" for="qtdRefSaida" />
	                    <h:inputText id="qtdRefSaida" value="#{produtoMb.produto.qtdRefSaida}" />
	                    
	                    <h:outputLabel value="Alíquota IPI" for="aliqIpi" />
	                    <h:inputText id="aliqIpi" value="#{produtoMb.produto.aliqIpi}" title="Alíquota IPI" />
	                    
	                    <h:outputLabel value="Alíquota ICMS" for="aliqIcms" />
	                    <h:inputText id="aliqIcms" value="#{produtoMb.produto.aliqIcms}" title="Alíquota ICMS" />
	                    
	                    <h:outputLabel value="Fator Coacção" for="fatorCoacao" />
	                    <h:inputText id="fatorCoacao" value="#{produtoMb.produto.fatorCoaccao}" title="Fator Coacção" />
	                    
	                    <h:outputLabel value="Índice Coacção" for="indiceCoacao" />
	                    <h:inputText id="indiceCoacao" value="#{produtoMb.produto.indiceCoaccao}" title="Índice Coacção" />	                    
	                    
	                    <h:outputLabel value="Qtd. Mínima Estoque" for="qtdMinProd" />
	                    <h:inputText id="qtdMinProd" value="#{produtoMb.produto.qtdMinima}" />
	                    	                    
	                    <h:outputLabel value="Empresa" for="empresaId" />
	                    <h:selectOneMenu id="empresaId" value="#{produtoMb.empresaAux.id}" title="Selecione a empresa vinculada" style="width:250px">
	                        <f:selectItem itemValue="#{null}" itemLabel=""/>
	                        <f:selectItems value="#{produtoMb.empresas}" var="emp" itemValue="#{emp.id}" itemLabel="#{emp.nomeFantasia}"/>
	                    </h:selectOneMenu>	        
	                    
	                    <h:outputLabel value="Tipo" for="tipoProdutoId" />
	                    <h:panelGroup id="selPanel" style="border:none; padding: 0px 0px;">
		                    <h:selectOneMenu id="tipoProdutoId" value="#{produtoMb.tipo.id}" title="Tipo de Produto" style="width:200px">
		                        <f:selectItem itemLabel="" itemValue="#{null}" noSelectionOption="true"/>		                    
		                        <f:selectItems value="#{produtoMb.itemsTipoProduto}" var="tp" itemLabel="#{tp.nome}" itemValue="#{tp.id}"/>
		                    </h:selectOneMenu>		                    
	                    </h:panelGroup>
	                    
	                    <h:outputLabel value="Grupo" for="grupoProdutoId" />
	                    <h:panelGroup id="selPanelG" layout="block">
		                    <h:selectOneMenu id="grupoProdutoId" value="#{produtoMb.grupo.id}" title="Grupo de Produto" style="width:200px">
		                        <f:selectItem itemLabel="" itemValue="0" noSelectionOption="true"/>
		                        <f:selectItems value="#{produtoMb.itemsGrupoProduto}" var="tp" itemLabel="#{tp.descricao}" itemValue="#{tp.id}"/>
		                    </h:selectOneMenu>
	                    </h:panelGroup>
	                    
	                    <h:outputLabel value="Data Inclusão" for="datainclusao" />
	                    <h:outputLabel id="datainclusao" value="#{produtoMb.produto.datainclusao}" >
	                        <f:convertDateTime pattern="dd/MM/yyyy" />
	                    </h:outputLabel>
	                    
	                    <h:outputLabel value="Data Alteração" for="dataalteracao" />
	                    <h:outputLabel id="dataalteracao" value="#{produtoMb.produto.dataalteracao}" >
	                        <f:convertDateTime pattern="dd/MM/yyyy" />
	                    </h:outputLabel>
	                    
	                </h:panelGrid>
                	    
					<br/><br/><hr/>
										
		            <h:commandLink action="#{produtoMb.inserirControleEstoque(produtoMb.produto)}" value="" title="Controlar estoque deste produto" > 
				    	<h:graphicImage value="/css/img/valida.png" width="20px" height="20px" />
				    	<h:outputLabel value="_Controlar em estoque" />
				    </h:commandLink>
		            					
				</div>
				</td></tr></table>	
		    </p:panel>
		    
		    <p:panel header="Lista de produtos" style="width:100%; height: 95%; " rendered="#{produtoMb.mostrarLista}">
		    	<table><tr><td width="1300px">
		    	<div style="padding-left: 10px">
			      	<nav class="navbar navbar-default" style="min-height: 30px !important;">
		  				<div class="container-fluid">
				      		<span class="btn-group navbar-right">
				      			<span class="btn-group">
									<h:commandLink styleClass="btn btn-link" action="#{produtoMb.alternaMostraLista()}" value="Ver detalhe" />
								</span>				      			
				      		</span>
				      	</div>
				    </nav>	
				</div>    
		    	<p:dataTable value="#{produtoMb.listProduto}" var="us" style="width:100%" id="tbProdutos">
		    			<p:column>
		    				<f:facet name="header">Nome</f:facet>
		    				<h:outputText value="#{us.nome}" />
		    			</p:column>
		    			<p:column>
		    				<f:facet name="header">Descricao</f:facet>
		    				<h:outputText value="#{us.descricao}" />
		    			</p:column>
		    			<p:column>
		    				<f:facet name="header">Medida</f:facet>
		    				<h:outputText value="#{us.medida}" />
		    			</p:column>
		    			<p:column>
		    				<f:facet name="header">Ação</f:facet>
				      		<center><h:commandLink action="#{produtoMb.editar(us)}" value="" title="Editar dados deste registro" > 
				      			<h:graphicImage value="/css/img/edit.png" width="20px" height="20px" /></h:commandLink>
				      		</center>
		    			</p:column>
		    	</p:dataTable>
		    	</td></tr></table>
		    </p:panel>
   
		    
	    </h:form>
    </ui:define>
    
</ui:composition>


    
